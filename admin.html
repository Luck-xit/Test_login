<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin â€” Luck modz</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<style>
  :root{
    --bg:#0f1724; --card:#0b1220; --accent:#2575fc; --muted:#9aa6bf; --glass: rgba(255,255,255,0.04); --success:#1abc9c;
    --danger:#e74c3c;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,Arial,sans-serif;
    background: linear-gradient(180deg,#071228 0%, #0b1830 100%);
    color:#e6eef6;
    min-height:100vh;
  }

  header{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:18px 20px;border-bottom:1px solid rgba(255,255,255,0.03);background: linear-gradient(90deg, rgba(255,255,255,0.02), transparent);}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#6a11cb);display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 6px 18px rgba(37,117,252,0.15);}
  .brand h1{font-size:18px;margin:0}
  .header-actions{display:flex;gap:12px;align-items:center}
  .user-bubble{padding:6px 10px;border-radius:10px;background:rgba(255,255,255,0.02);color:var(--muted)}
  .btn {padding:8px 12px;border-radius:10px;border:0;background:var(--accent);color:white;cursor:pointer;}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
  .btn.danger{background:var(--danger);color:white}

  main{max-width:1200px;margin:20px auto;padding:18px;display:grid;grid-template-columns:360px 1fr;gap:20px}
  .panel {background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);}
  .panel h2{margin:6px 0 12px;font-size:16px}
  label{display:block;font-size:13px;color:var(--muted);margin-top:8px}
  input[type="text"], input[type="url"], input[type="number"], textarea, select {
    width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;margin-top:6px;
  }
  textarea{min-height:90px;resize:vertical}
  .row{display:flex;gap:8px}
  .row .col{flex:1}
  .small{font-size:13px;color:var(--muted);margin-top:6px}
  .actions{display:flex;gap:8px;margin-top:12px}
  .actions .btn{flex:1}
  .list {display:flex;flex-direction:column;gap:12px;}
  .hack {display:flex;gap:12px;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.02);}
  .thumb{width:92px;height:64px;border-radius:8px;flex:0 0 92px;background:#071427;overflow:hidden;display:flex;align-items:center;justify-content:center}
  .thumb img{width:100%;height:100%;object-fit:cover;display:block}
  .meta{flex:1;min-width:0}
  .meta h3{margin:0;font-size:15px}
  .meta p{margin:6px 0 0;font-size:13px;color:var(--muted);overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
  .meta .sub{font-size:12px;color:var(--muted);margin-top:6px}
  .controls-hack{display:flex;flex-direction:column;gap:6px;align-items:flex-end}
  .controls-hack button{padding:6px 8px;border-radius:8px;border:0;cursor:pointer}
  .edit{background:rgba(37,117,252,0.12);color:var(--accent)}
  .del{background:rgba(231,76,60,0.12);color:var(--danger)}
  .search-admin{margin-bottom:10px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
  footer{padding:20px;text-align:center;color:var(--muted);font-size:13px}
  @media (max-width:980px){main{grid-template-columns:1fr; padding:12px}}
  .preview {margin-top:12px;border-radius:12px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02);}
  .preview .preview-thumb{width:100%;height:160px;border-radius:10px;overflow:hidden;background:#071427;display:flex;align-items:center;justify-content:center}
  .preview .preview-thumb img{width:100%;height:100%;object-fit:cover}
  .preview h3{margin:8px 0 0}
  .preview p{color:var(--muted);margin:6px 0 0}
  .metrics-charts{display:flex;gap:10px;align-items:center;margin-top:10px}
  canvas{background:transparent;border-radius:8px}
  .overlay {position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(3,7,18,0.55);z-index:9999;display:none;}
  .spinner{width:84px;height:84px;border-radius:16px;background:linear-gradient(180deg,#071428,#071a34);display:flex;align-items:center;justify-content:center;box-shadow:0 10px 30px rgba(0,0,0,0.6);}
  .dot{width:12px;height:12px;background:var(--accent);border-radius:50%;margin:4px;animation:pop 0.9s infinite}
  .dot:nth-child(2){animation-delay:0.12s}
  .dot:nth-child(3){animation-delay:0.24s}
  @keyframes pop{0%{transform:scale(.6);opacity:.3}50%{transform:scale(1.1);opacity:1}100%{transform:scale(.6);opacity:.3}}
  .toast{position:fixed;right:20px;bottom:20px;background:#0f1724;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;color:var(--muted);box-shadow:0 8px 30px rgba(0,0,0,0.6)}
</style>
</head>
<body>
  <header> ... </header>

  <main> ... </main>

  <footer>Â© Luck modz â€” 2024 - 2025</footer>

  <div id="toast" class="toast" style="display:none"></div>

  <div id="overlay" class="overlay"><div class="spinner"><div style="display:flex"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div></div></div>

<script type="module">
  /* --- CÃ“DIGO ORIGINAL --- */
  // (todo tu cÃ³digo de Firebase, eventos y lÃ³gica sigue igual)
  
  // ðŸ‘‡ FILTRO NUEVO para que cada admin vea solo lo suyo
  function renderHacksList(filter=''){
    hacksList.innerHTML = '';
    const arr = Object.entries(allHacks || {});
    const q = (filter||'').trim().toLowerCase();

    // ðŸ”‘ filtro por usuario logueado
    const myName = (currentUserProfile && currentUserProfile.username) || (auth.currentUser && auth.currentUser.email) || '';
    const filteredArr = arr.filter(([id,h])=>{
      const creador = h.createdByUsername || h.createdBy || '';
      return creador === myName; // solo los suyos
    });

    filteredArr.sort((a,b)=>{
      const ta = a[1].timestamp||0;
      const tb = b[1].timestamp||0;
      return tb - ta;
    });

    if (filteredArr.length === 0){
      hacksList.innerHTML = `<div class="small" style="color:var(--muted)">No has publicado hacks todavÃ­a.</div>`;
      return;
    }

    filteredArr.forEach(([id, h])=>{
      if (q && !( (h.title||'').toLowerCase().includes(q) || (h.game||'').toLowerCase().includes(q))) return;
      const div = document.createElement('div');
      div.className = 'hack';
      div.innerHTML = `
        <div class="thumb"><img src="${escapeAttr(h.imageURL||'')}" /></div>
        <div class="meta">
          <h3>${escapeHtml(h.title||'Sin tÃ­tulo')}</h3>
          <p>${escapeHtml((h.description||'').slice(0,140))}</p>
          <div class="sub">Juego: ${escapeHtml(h.game||'Sin juego')} â€¢ ${escapeHtml(h.category||'Sin categorÃ­a')}</div>
        </div>
        <div class="controls-hack">
          <button class="edit" data-id="${id}">Editar</button>
          <button class="del" data-id="${id}">Eliminar</button>
        </div>`;
      hacksList.appendChild(div);
    });

    hacksList.querySelectorAll('button.edit').forEach(b=> b.onclick = ()=> startEditHack(b.dataset.id));
    hacksList.querySelectorAll('button.del').forEach(b=>{
      b.onclick = async ()=>{
        const id = b.dataset.id;
        const creador = allHacks[id].createdByUsername || allHacks[id].createdBy || '';
        if (creador !== myName) return showToast('No puedes eliminar hacks de otros administradores');
        if (!confirm('Â¿Eliminar este hack?')) return;
        await remove(ref(db, 'hacks/' + id));
        showToast('Hack eliminado');
      };
    });
  }
</script>
</body>
</html>
